---
description: "Updates and details an existing TODO list when new information is discovered."
---

# Инструкция по Обновлению и Детализации TODO-листа

## Контекст и Триггер

Этот процесс запускается, когда одна общая задача в существующем плане (например, `[ ] 2.5: Исправить все упавшие тесты`) оказывается слишком широкой и требует разбивки на конкретные подзадачи.

**Триггер:** Анализ (чтение файла, вывод логов, результаты тестов), который выявляет конкретные шаги, необходимые для выполнения общей задачи.

## Основные Принципы

### 1. Декомпозиция
Основная цель — **заменить один общий пункт** в плане на **несколько детализированных, атомарных пунктов**. Это превращает неопределенную задачу в четкий, пошаговый план.

### 2. Сохранение Структуры
Обновление должно строго следовать правилам изначального создания задач:
- **Атомарность:** Каждая новая задача — одно неделимое действие.
- **Разделение Обязанностей:** Административные задачи (`Запустить тесты`, `Обновить Memory Bank`, `Сделать коммит`) остаются отдельными пунктами.
- **Нумерация:** Новые задачи вставляются в план, а нумерация всех последующих задач в фазе сдвигается.

## Процесс Обновления

1.  **Пауза и Анализ:** Остановиться перед выполнением общей задачи. Проанализировать новую информацию и определить конкретные подзадачи.
2.  **Формулирование Нового Плана:** Сформулировать новый, детализированный список задач, который заменит старый общий пункт.
3.  **Предложение Обновления:** Предложить пользователю обновить план, показав, как он будет выглядеть, выделить в тексте обновленную информацию для удобночитаемости.
4.  **Исполнение:** После одобрения:
    а. Записать обновленный полный план в соответствующий `.md` файл задачи.
    б. Использовать инструмент `update_todo_list`, чтобы синхронизировать глобальный список задач с новым планом.

## Пример Рабочего Процесса

**Ситуация:** Текущая задача — `2.5: Исправить все упавшие тесты`. После запуска тестов выяснилось, что проблемы есть в двух конкретных файлах.

**Шаг 1: Анализ**
"Я проанализировал вывод тестов и обнаружил, что ошибки происходят в `tests/unit/logging/test_core_logging.py` и `tests/unit/trading/test_trading_cycle.py`. Задача 'Исправить все тесты' слишком общая. Я предлагаю детализировать план."

**Шаг 2: Предложение нового плана**

**ДО ОБНОВЛЕНИЯ:**

--- ФАЗА 2: Обновление компонентов и исправление тестов ---

```
[ ] 2.4: В src/market_data/market_data_service.py обновить создание логгера.
[ ] 2.5: Исправить все упавшие тесты.
[ ] 2.6: Запустить все тесты (tests/run_all_tests.py).
[ ] 2.7: Обновить Memory Bank.
[ ] 2.8: Сделать коммит.
```

**ПОСЛЕ ОБНОВЛЕНИЯ (предлагаемый план):**

--- ФАЗА 2: Обновление компонентов и исправление тестов ---

```
[ ] 2.4: В src/market_data/market_data_service.py обновить создание логгера.
[ ] 2.5: Исправить тесты в tests/unit/logging/test_core_logging.py.
[ ] 2.6: Исправить тесты в tests/unit/trading/test_trading_cycle.py.
[ ] 2.7: Запустить все тесты (tests/run_all_tests.py). (старый пункт 2.6)
[ ] 2.8: Обновить Memory Bank. (старый пункт 2.7)
[ ] 2.9: Сделать коммит. (старый пункт 2.8)
```

**Шаг 3: Исполнение**
После одобрения пользователем, ассистент должен будет обновить этот новый план в файл и обновить TODO-лист с помощью `update_todo_list`.